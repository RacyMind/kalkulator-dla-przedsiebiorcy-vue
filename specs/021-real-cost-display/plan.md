# Implementation Plan: Rzeczywisty koszt zakupu — wyświetlanie kosztu rzeczywistego

**Branch**: `021-real-cost-display` | **Date**: 2026-02-10 | **Spec**: [spec.md](spec.md)
**Input**: Feature specification from `/specs/021-real-cost-display/spec.md`

**Note**: This template is filled by the `/speckit.plan` command.

## Summary

Moduł "Rzeczywisty koszt zakupu" oblicza składowe (VAT, podatek dochodowy, składka zdrowotna, zaoszczędzona kwota), ale brakuje tytułowej pozycji — rzeczywistego kosztu zakupu. Zmiana polega na dodaniu pola `realCost = price - savedAmount` do interfejsu `Result`, obliczeniu go w kalkulatorze, wyświetleniu jako wyróżnionej pozycji w UI i aktualizacji testów.

## Technical Context

**Language/Version**: TypeScript 4.5+ / Vue 3.4+  
**Framework**: Quasar 2.18+ (UI components)  
**State Management**: Pinia 2.x  
**Testing**: Vitest 2.x  
**Platform**: PWA (Progressive Web App) + Capacitor (Android)  
**Project Type**: Single-page application (SPA)  
**UI Language**: Polish  
**Key Dependencies**:

- BasicCalculator - base class for all calculators (already used by RealBoughtCostCalculator)
- ListRow component - UI row with optional `highlight` prop
- helpers.round() - rounding to 2 decimal places
- pln() composable - currency formatting

**No unknowns** — all patterns are established in the existing module.

## Constitution Check

_GATE: Must pass before Phase 0 research. Re-check after Phase 1 design._

Constitution is not configured (template placeholders only). No gates to enforce. ✅

**Post-design re-check**: No violations. Feature follows existing module patterns.

## Project Structure

### Documentation (this feature)

```text
specs/021-real-cost-display/
├── plan.md              # This file
├── spec.md              # Feature specification
├── research.md          # Research and analysis
├── data-model.md        # Data model
├── quickstart.md        # Quick start
├── contracts/           # API contracts (N/A - frontend only)
│   └── README.md
├── checklists/
│   └── requirements.md  # Spec quality checklist
└── tasks.md             # Task list (generated by /speckit.tasks)
```

### Source Code (files to modify)

```text
src/components/realBoughtCosts/
├── components/
│   └── ResultList.vue          # Add "Rzeczywisty koszt zakupu" row
├── interfaces/
│   └── Result.ts               # Add realCost field
├── logic/
│   └── RealBoughtCostCalculator.ts  # Compute realCost
├── pages/
│   └── Index.vue               # No changes
└── store.ts                    # No changes

test/vitest/__tests__/modules/realBoughtCost/
└── RealBoughtCostCalculator.test.ts  # Add realCost assertions
```

**Module Pattern**: Existing `src/components/realBoughtCosts/` — this is a modification, not a new module.

## Change Summary

| #   | File                                | Change                                                                                      | Complexity |
| --- | ----------------------------------- | ------------------------------------------------------------------------------------------- | ---------- |
| 1   | `interfaces/Result.ts`              | Add `readonly realCost: number`                                                             | Trivial    |
| 2   | `logic/RealBoughtCostCalculator.ts` | Add `realCost: helpers.round(price - savedAmount, 2)` to result                             | Trivial    |
| 3   | `components/ResultList.vue`         | Add highlighted "Rzeczywisty koszt zakupu" row; remove highlight from "Zaoszczędzona kwota" | Simple     |
| 4   | `RealBoughtCostCalculator.test.ts`  | Add `expect(result.realCost).toBe(...)` to all 4 test cases                                 | Simple     |

## Pre-Implementation Checklist

- [x] Calculator logic extends `BasicCalculator` (already does)
- [x] UI components use Quasar (ListRow already used)
- [x] UI text in Polish language ("Rzeczywisty koszt zakupu")
- [N/A] Validation uses `validationRules` (no new form fields)
- [ ] Tests include all output values (must add `realCost`)
- [N/A] Constants added to `src/logic/constants.ts` (no new constants)
- [ ] Changelog updated in `src/components/changeLogs/logs.ts`
